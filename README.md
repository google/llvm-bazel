# LLVM Bazel BUILD files

DISCLAIMER: This is not an officially-supported Google project and is still in
development.

This repo contains standalone Bazel BUILD configuration for part  of the
[LLVM project](http://llvm.org/) that could be shared by dependent projects
using the Bazel build system.

It is branched off of the BUILD files for
[LLVM](https://github.com/tensorflow/tensorflow/blob/master/third_party/llvm/llvm.autogenerated.BUILD)
and [MLIR](https://github.com/tensorflow/tensorflow/blob/master/third_party/mlir/BUILD)
in the [TensorFlow](http://tensorflow.org) project, but aims to be
suitable for more general usage.

# Status

MLIR builds with Cuda and Vulkan support disabled.

Building LLVM core has many issues with finding `.inc` files.

# Usage

These build files are flexible in how they can be used. The
[llvm-bazel subdirectory](./llvm-bazel) has the simplest build configuration
with a submodule for the llvm-project and the build files in tree.

Users are more likely going to want to fetch build files from this repository
and use them with their own copy of the llvm-project.

The
[http-archive-demo branch](https://github.com/google/llvm-bazel/tree/http-archive-demo/http-archive-demo)
shows a build based on
[http_archive](https://docs.bazel.build/versions/master/repo/http.html#http_archive).

The
[submodule-demo branch](https://github.com/google/llvm-bazel/tree/submodule-demo/submodule-demo)
shows usage of these build files with both them and llvm-project coming from
submodules.

You can build either of these demos with a command like

```shell
bazel --config=generic_clang @llvm-project//mlir/...
```

# Generating BUILD files

Build files can be generated from LLVMBuild.txt files by running the provided
script.

```shell
sed -i '/Begin autogenerated content/Q' llvm-bazel/llvm-project-overlay/llvm/BUILD \
    && llvm-bazel/generate_bazel_build.py \
    --llvm_root=third_party/llvm-project/llvm \
    >> llvm-bazel/llvm-project-overlay/llvm/BUILD

```

# License
Licensed under the Apache license with LLVM Exceptions. See [LICENSE](LICENSE)
for more information.
